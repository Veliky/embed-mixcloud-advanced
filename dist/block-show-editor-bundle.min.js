!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=19)}([function(e,t){!function(){e.exports=this.wp.element}()},function(e,t){!function(){e.exports=this.wp.components}()},function(e,t){!function(){e.exports=this.wp.i18n}()},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(4),i=r.n(n),o=r(3),l=r.n(o),c=[],a=function(){function e(t,r,n,o){i()(this,e),this.container=t,this.previewBtn=r,this.onPlay=o,this.play=this.play.bind(this),this.stop=this.stop.bind(this),this.on=this.on.bind(this),this.off=this.off.bind(this),this.onClick=this.onClick.bind(this),n&&!this.audio&&(this.audio=new Audio(n),this.audio.load(),this.audio.addEventListener("loadeddata",this.on),this.audio.addEventListener("pause",this.stop)),this.playing=!1,this.available=!0}return l()(e,null,[{key:"getInstance",value:function(t,r,n,i){var o=new e(t,r,n,i);return c.push(o),o}},{key:"pauseAll",value:function(e){c.forEach((function(t){t!==e&&(t.stop(!1),t.onPlay())}))}}]),l()(e,[{key:"on",value:function(){this.previewBtn.addEventListener("click",this.onClick)}},{key:"off",value:function(){this.previewBtn.removeEventListener("click",this.onClick)}},{key:"onClick",value:function(){this.playing?this.stop(!1):this.play()}},{key:"updateSpinnerDuration",value:function(e){this.container.style.setProperty("--spinner-duration",e+"s")}},{key:"updateSpinnerProgress",value:function(e){var t=56.52/(this.audio.duration/e)+", "+(56.52-56.52/(this.audio.duration/e));this.container.style.setProperty("--spinner-progress",t)}},{key:"play",value:function(){var e=this;this.constructor.pauseAll(this),this.onPlay(),!this.playing&&this.available&&(this.playing=!0,setTimeout((function(){e.playing&&e.audio&&e.audio.play().then((function(){e.updateSpinnerDuration(e.audio.duration-e.audio.currentTime),e.container.className=e.container.className.replace(" mea-show__wrapper_pause",""),e.container.className+=" mea-show__wrapper_playing"}))}),500))}},{key:"stop",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.playing&&(this.playing=!1,this.audio&&(this.audio.pause(),e?this.audio.currentTime=0:(this.container.className+=" mea-show__wrapper_pause",this.updateSpinnerProgress(this.audio.currentTime)),this.container.className=this.container.className.replace(" mea-show__wrapper_playing","")))}},{key:"blink",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.container.className+=" mea-show__wrapper_playing",this.updateSpinnerDuration(t),setTimeout((function(){e.container.className=e.container.className.replace(" mea-show__wrapper_playing","")}),1e3*t)}}]),e}()},function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(t)}e.exports=r},function(e,t,r){var n=r(20);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},function(e,t,r){var n=r(21),i=r(5);e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?i(e):t}},function(e,t){!function(){e.exports=this.wp.blockEditor}()},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t){!function(){e.exports=this.wp.data}()},function(e,t){!function(){e.exports=this.regeneratorRuntime}()},function(e,t){!function(){e.exports=this.wp.blocks}()},function(e,t){!function(){e.exports=this.wp.compose}()},function(e,t){function r(e,t,r,n,i,o,l){try{var c=e[o](l),a=c.value}catch(e){return void r(e)}c.done?t(a):Promise.resolve(a).then(n,i)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var l=e.apply(t,n);function c(e){r(l,i,o,c,a,"next",e)}function a(e){r(l,i,o,c,a,"throw",e)}c(void 0)}))}}},function(e,t,r){var n=r(22),i=r(23),o=r(24),l=r(26);e.exports=function(e,t){return n(e)||i(e,t)||o(e,t)||l()}},function(e,t){!function(){e.exports=this.lodash}()},function(e,t,r){e.exports=r(29)},function(e,t){function r(t,n){return e.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(t,n)}e.exports=r},function(e,t){function r(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=r=function(e){return typeof e}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(t)}e.exports=r},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(n=(l=c.next()).done)&&(r.push(l.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw o}}return r}}},function(e,t,r){var n=r(25);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},,,function(e,t,r){"use strict";r.r(t),r.d(t,"matchMixcloudUrl",(function(){return ne}));var n=r(0),i=r(2),o=r(14),l=r(15),c=r(12),a=r(13),s=r.n(a),u=r(16),p=r.n(u),h=r(4),d=r.n(h),f=r(3),v=r.n(f),w=r(5),b=r.n(w),m=r(8),y=r.n(m),g=r(9),O=r.n(g),j=r(7),k=r.n(j),_=r(10),E=r(1),x=(Object(n.createElement)(E.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Object(n.createElement)(E.Path,{fill:"none",d:"M0 0h24v24H0V0z"}),Object(n.createElement)(E.Path,{d:"M21 3H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H3V5h18v14zM8 15c0-1.66 1.34-3 3-3 .35 0 .69.07 1 .18V6h5v2h-3v7.03c-.02 1.64-1.35 2.97-3 2.97-1.66 0-3-1.34-3-3z"})),Object(n.createElement)(E.SVG,{viewBox:"0 0 302.4 302.4",xmlns:"http://www.w3.org/2000/svg"},Object(n.createElement)("path",{d:"M204.8,97.6C191.2,84,172,75.2,151.2,75.2s-40,8.4-53.6,22.4c-13.6,13.6-22.4,32.8-22.4,53.6s8.8,40,22.4,53.6 c13.6,13.6,32.8,22.4,53.6,22.4s40-8.4,53.6-22.4c13.6-13.6,22.4-32.8,22.4-53.6S218.8,111.2,204.8,97.6z"}),Object(n.createElement)("path",{d:"M151.2,51.6c5.6,0,10.4-4.8,10.4-10.4V10.4c0-5.6-4.8-10.4-10.4-10.4c-5.6,0-10.4,4.8-10.4,10.4v30.8 C140.8,46.8,145.6,51.6,151.2,51.6z"}),Object(n.createElement)("path",{d:"M236.4,80.8l22-22c4-4,4-10.4,0-14.4s-10.4-4-14.4,0l-22,22c-4,4-4,10.4,0,14.4C225.6,84.8,232,84.8,236.4,80.8z"}),Object(n.createElement)("path",{d:"M292,140.8h-30.8c-5.6,0-10.4,4.8-10.4,10.4c0,5.6,4.8,10.4,10.4,10.4H292c5.6,0,10.4-4.8,10.4-10.4 C302.4,145.6,297.6,140.8,292,140.8z"}),Object(n.createElement)("path",{d:"M236,221.6c-4-4-10.4-4-14.4,0s-4,10.4,0,14.4l22,22c4,4,10.4,4,14.4,0s4-10.4,0-14.4L236,221.6z"}),Object(n.createElement)("path",{d:"M151.2,250.8c-5.6,0-10.4,4.8-10.4,10.4V292c0,5.6,4.8,10.4,10.4,10.4c5.6,0,10.4-4.8,10.4-10.4v-30.8 C161.6,255.6,156.8,250.8,151.2,250.8z"}),Object(n.createElement)("path",{d:"M66,221.6l-22,22c-4,4-4,10.4,0,14.4s10.4,4,14.4,0l22-22c4-4,4-10.4,0-14.4C76.8,217.6,70.4,217.6,66,221.6z"}),Object(n.createElement)("path",{d:"M51.6,151.2c0-5.6-4.8-10.4-10.4-10.4H10.4c-5.6,0-10.4,4.8-10.4,10.4s4.8,10.4,10.4,10.4h30.8 C46.8,161.6,51.6,156.8,51.6,151.2z"}),Object(n.createElement)("path",{d:"M66,80.8c4,4,10.4,4,14.4,0s4-10.4,0-14.4l-22-22c-4-4-10.4-4-14.4,0s-4,10.4,0,14.4L66,80.8z"}))),C=Object(n.createElement)(E.SVG,{viewBox:"0 0 480 480",xmlns:"http://www.w3.org/2000/svg"},Object(n.createElement)(E.Path,{d:"M459.782,347.328c-4.288-5.28-11.488-7.232-17.824-4.96c-17.76,6.368-37.024,9.632-57.312,9.632 c-97.056,0-176-78.976-176-176c0-58.4,28.832-112.768,77.12-145.472c5.472-3.712,8.096-10.4,6.624-16.832 S285.638,2.4,279.078,1.44C271.59,0.352,264.134,0,256.646,0c-132.352,0-240,107.648-240,240s107.648,240,240,240 c84,0,160.416-42.688,204.352-114.176C464.55,360.032,464.038,352.64,459.782,347.328z"})),P=Object(n.createElement)(E.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Object(n.createElement)(E.Rect,{height:"20",width:"20",y:"2",x:"2",fillOpacity:"0",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor"})),S=Object(n.createElement)(E.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Object(n.createElement)(E.Rect,{height:"12",width:"22",y:"6",x:"1",fillOpacity:"0",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor"}),Object(n.createElement)("line",{strokeLinecap:"null",strokeLinejoin:"null",y2:"7",x2:"11",y1:"18",x1:"11",fillOpacity:"null",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor",fill:"none"}),Object(n.createElement)("line",{strokeLinecap:"null",strokeLinejoin:"null",y2:"12",x2:"11",y1:"12",x1:"22",fillOpacity:"null",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor",fill:"none"})),L=Object(n.createElement)(E.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Object(n.createElement)(E.Rect,{height:"8",width:"22",y:"8",x:"1",fillOpacity:"0",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor"}),Object(n.createElement)("line",{strokeLinecap:"null",strokeLinejoin:"null",y2:"9",x2:"10",y1:"16",x1:"10",fillOpacity:"null",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor",fill:"none"})),A=Object(n.createElement)(E.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Object(n.createElement)(E.Rect,{height:"12",width:"22",y:"6",x:"1",fillOpacity:"0",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor"}),Object(n.createElement)("line",{strokeLinecap:"null",strokeLinejoin:"null",y2:"12",x2:"2",y1:"12",x1:"22",fillOpacity:"null",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor",fill:"none"})),U=Object(n.createElement)(E.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Object(n.createElement)(E.Rect,{height:"12",width:"22",y:"6",x:"1",fillOpacity:"0",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor"})),W=Object(n.createElement)(E.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Object(n.createElement)(E.Rect,{height:"8",width:"22",y:"8",x:"1",fillOpacity:"0",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor"})),R=Object(n.createElement)(E.SVG,{className:"mea-show__spinner",width:"20",height:"20",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},Object(n.createElement)(E.Circle,{cx:"10",cy:"10",r:"9"}),Object(n.createElement)("path",{d:"M8 6l6 4.03L8 14V6z",fill:"currentColor"})),T=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t="mea-show__spinner"+(e?" mea-show__spinner_download":"");return Object(n.createElement)(E.SVG,{className:t,width:"20",height:"20",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},Object(n.createElement)(E.Circle,{cx:"10",cy:"10",r:"9"}),Object(n.createElement)("path",{d:"M14 8l-4.03 6L6 8h8z",fill:"currentColor"}))},B=Object(n.createElement)(E.SVG,{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",role:"img","aria-hidden":"true",focusable:"false"},Object(n.createElement)("line",{strokeLinecap:"null",strokeLinejoin:"null",y2:"2",x2:"1",y1:"2",x1:"9",fillOpacity:"null",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor",fill:"none"}),Object(n.createElement)(E.Rect,{height:"12",width:"22",y:"6",x:"1",fillOpacity:"0",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor"}),Object(n.createElement)("line",{strokeLinecap:"null",strokeLinejoin:"null",y2:"7",x2:"11",y1:"18",x1:"11",fillOpacity:"null",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor",fill:"none"}),Object(n.createElement)("line",{strokeLinecap:"null",strokeLinejoin:"null",y2:"12",x2:"11",y1:"12",x1:"22",fillOpacity:"null",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor",fill:"none"})),M=Object(n.createElement)(E.SVG,{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",role:"img","aria-hidden":"true",focusable:"false"},Object(n.createElement)("line",{strokeLinecap:"null",strokeLinejoin:"null",y2:"2",x2:"8",y1:"2",x1:"16",fillOpacity:"null",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor",fill:"none"}),Object(n.createElement)(E.Rect,{height:"12",width:"22",y:"6",x:"1",fillOpacity:"0",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor"}),Object(n.createElement)("line",{strokeLinecap:"null",strokeLinejoin:"null",y2:"7",x2:"11",y1:"18",x1:"11",fillOpacity:"null",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor",fill:"none"}),Object(n.createElement)("line",{strokeLinecap:"null",strokeLinejoin:"null",y2:"12",x2:"11",y1:"12",x1:"22",fillOpacity:"null",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor",fill:"none"})),N=Object(n.createElement)(E.SVG,{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",role:"img","aria-hidden":"true",focusable:"false"},Object(n.createElement)("line",{strokeLinecap:"null",strokeLinejoin:"null",y2:"2",x2:"15",y1:"2",x1:"23",fillOpacity:"null",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor",fill:"none"}),Object(n.createElement)(E.Rect,{height:"12",width:"22",y:"6",x:"1",fillOpacity:"0",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor"}),Object(n.createElement)("line",{strokeLinecap:"null",strokeLinejoin:"null",y2:"7",x2:"11",y1:"18",x1:"11",fillOpacity:"null",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor",fill:"none"}),Object(n.createElement)("line",{strokeLinecap:"null",strokeLinejoin:"null",y2:"12",x2:"11",y1:"12",x1:"22",fillOpacity:"null",strokeOpacity:"null",strokeWidth:"2",stroke:"currentColor",fill:"none"})),D=function(e){var t=e.cannotEmbed,r=e.url,o=e.previewInfoLink,l=e.loadPreview,c=e.onSubmit,a=e.onChangeUrl,s=e.onChangeLoadPreview;return Object(n.createElement)(E.Placeholder,{icon:Object(n.createElement)(_.BlockIcon,{icon:R,showColors:!0}),label:Object(i.__)("Mixcloud Advanced"),className:"wp-block-embed",instructions:t?Object(i.__)("This content could not be embedded!"):Object(i.__)("Paste a link to the content you want to display on your site.")},Object(n.createElement)("form",{onSubmit:c},Object(n.createElement)("input",{type:"url",value:r||"",className:"components-placeholder__input"+(t?" components-placeholder__input-error":""),"aria-label":Object(i.__)("Mixcloud URL"),placeholder:Object(i.__)("Enter URL to embed here…"),onChange:a}),Object(n.createElement)(E.Button,{isSecondary:!0,type:"submit"},Object(i._x)("Embed","button label"))),Object(n.createElement)("form",null,Object(n.createElement)(E.CheckboxControl,{className:"components-placeholder__learn-more",label:Object(i.__)("Enable preview"),checked:l,onChange:s})),Object(n.createElement)("div",null,Object(n.createElement)("div",null,Object(i.__)("This function can be disabled. To download preview data, a request will be made from the server to the show page.")," ",Object(n.createElement)(E.ExternalLink,{href:o,target:"_blank"},"See more"))))},V=r(17),z=r.n(V),G=r(6);function I(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var q=function(e){y()(o,e);var t,r=(t=o,function(){var e,r=k()(t);if(I()){var n=k()(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return O()(this,e)});function o(e){var t;return d()(this,o),(t=r.call(this,e)).hideOverlay=t.hideOverlay.bind(b()(t)),t.state={interactive:!1},t._iframe=Object(n.createRef)(),t}return v()(o,[{key:"getContainer",value:function(){return this._iframe.current.parentElement.parentElement}},{key:"getPreviewBtn",value:function(){return this.getContainer().getElementsByClassName("mea-show__preview-btn")[0]}},{key:"componentDidMount",value:function(){var e=this;this.props.previewUrl&&(this.preview=G.a.getInstance(this.getContainer(),this.getPreviewBtn(),this.props.previewUrl,(function(){return e.pause()}))),this._iframe.current.addEventListener("load",(function(t){e.updateWidgetOptions()}))}},{key:"componentWillUnmount",value:function(){this.preview&&this.preview.stop()}},{key:"componentDidUpdate",value:function(){var e=this;!this.preview&&this.props.previewUrl&&(this.preview=G.a.getInstance(this.getContainer(),this.getPreviewBtn(),this.props.previewUrl,(function(){return e.pause()}))),this.preview&&(this.props.previewUrl?this.preview.on():this.preview.off()),this.updateWidgetOptions()}},{key:"pause",value:function(){void 0!==this.widget&&void 0!==this.widget.pause&&this.widget.pause()}},{key:"blinkPreview",value:function(){this.preview&&this.preview.blink()}},{key:"updateWidgetOptions",value:function(){var e=this,t=function(){e.widget.setOption&&(e.widget.setOption("mini",e.props.mini),e.widget.setOption("light",e.props.light),e.widget.setOption("hide_artwork",e.props.hideArtwork),e.widget.setOption("hide_cover",e.props.hideCover),e.props.autoplay?e.widget.play():e.widget.pause(),e.widget.events.play.on((function(){e.preview&&(e.preview.stop(!1),e.preview.constructor.pauseAll(e.preview))})))};void 0!==window.Mixcloud.PlayerWidget&&(this.widget&&this._iframe.current.getBoundingClientRect().y===this.iframeY||(this.widget=window.Mixcloud.PlayerWidget(this._iframe.current),this.iframeY=this._iframe.current.getBoundingClientRect().y,this.widget.ready.then((function(){e._iframe.current.style.setProperty("visibility","visible"),t()}))),t())}},{key:"hideOverlay",value:function(){this.setState({interactive:!0})}},{key:"getUrl",value:function(){var e=this.props,t=e.url,r=e.updateUrl,n=e.mini,i=e.hideCover,o=e.hideArtwork,l=e.light;if(t){var c=t.split(".com"),a=z()(c,2);a[0];return t="https://www.mixcloud.com/widget/iframe/?feed="+a[1]+(r?"&mini="+(0|n)+"&hide_cover="+(0|i)+"&hide_artwork="+(0|o)+"&light="+(0|l):"")}return!1}},{key:"render",value:function(){var e=this.props,t=e.previewUrl,r=e.height,o=e.light,l=e.previewAlign,c=e.autoplay,a=this.state.interactive,s=this.getUrl();if(s){var u="mea-show__container"+(t?" mea-show__container_with_preview":""),p=" mea-show__preview-btn_"+l;return Object(n.createElement)("div",{className:u,onFocus:this.hideOverlay},t&&Object(n.createElement)("div",{className:"mea-show__preview-btn "+(o?"mea-show__preview-btn_light":"")+p},R,Object(n.createElement)("span",null,Object(i.__)("Preview"))),Object(n.createElement)("div",{className:"mea-show__wrapper","data-preview-url":t},Object(n.createElement)("iframe",{ref:this._iframe,width:"100%",height:r,src:s,frameBorder:"0",allow:c?"autoplay":null})),!a&&Object(n.createElement)("div",{className:"block-library-embed__interactive-overlay",onMouseUp:this.hideOverlay}))}}}],[{key:"getDerivedStateFromProps",value:function(e,t){return!e.isSelected&&t.interactive?{interactive:!1}:null}}]),o}(n.Component),F=r(11),H=r.n(F);function Y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $(e){var t=e.url,r=e.emitLoadPreview,o=e.previewEnabled,l=e.togglePreviewEnabled,c=e.previewAlign,a=e.emitChangePreviewAlign,s=e.previewLoading,u={left:{icon:B,title:Object(i.__)("Left")},center:{icon:M,title:Object(i.__)("Center")},right:{icon:N,title:Object(i.__)("Right")}},p=Object.keys(u).map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(r),!0).forEach((function(t){H()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},u[e],{isActive:c===e,onClick:function(){return a(e)}})}));return t?Object(n.createElement)(n.Fragment,null,Object(n.createElement)(E.Toolbar,{controls:[{icon:R,title:Object(i.__)("Enable preview"),onClick:l,isActive:o}]}),o&&Object(n.createElement)(E.Toolbar,{icon:u[c]?u[c].icon:u.right.icon,label:Object(i.__)("Preview button align"),isCollapsed:!0,controls:p})):Object(n.createElement)(E.Toolbar,{icon:R,controls:[{icon:T(s),title:Object(i.__)("There is no preview data for this show. Download?"),isActive:!1,onClick:r}]})}var J=r(18);function K(e){var t=e.value,r=e.onClick;return Object(n.createElement)(E.Toolbar,{controls:["light","dark"].map((function(e){return{icon:"light"===e?x:C,title:Object(J.capitalize)(e),isActive:t===e,onClick:function(){return r(e)}}}))})}function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var X={picture:{title:Object(i.__)("Picture Widget"),icon:P,height:180,hideCover:!1},classic:{title:Object(i.__)("Classic Widget"),icon:S,height:120,hideCover:!0},noArtwork:{title:Object(i.__)("Widget w/o Artwork"),icon:A,height:120,hideArtwork:!0,hideCover:!0},covered:{title:Object(i.__)("Covered Widget"),icon:U,height:120,hideArtwork:!0,hideCover:!1},mini:{title:Object(i.__)("Mini Widget"),icon:L,height:60,hideCover:!0,mini:!0},minNoArtwork:{title:Object(i.__)("Mini Widget w/o Artwork"),icon:W,height:60,hideArtwork:!0,hideCover:!0,mini:!0}};function Z(e){var t=e.selected,r=e.onSelect,i=Object.keys(X).map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){H()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},X[e],{isActive:t===e,onClick:function(){return r(e)}})}));return Object(n.createElement)(E.Toolbar,{controls:i})}function ee(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var te="https://datcoder.com/mixcloud-embed-advanced/",re=function(e){y()(o,e);var t,r=(t=o,function(){var e,r=k()(t);if(ee()){var n=k()(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return O()(this,e)});function o(e){var t;return d()(this,o),(t=r.call(this,e)).setUrl=t.setUrl.bind(b()(t)),t.emitChangeUrl=t.emitChangeUrl.bind(b()(t)),t.requestPreview=t.requestPreview.bind(b()(t)),t.getWidgetProp=t.getWidgetProp.bind(b()(t)),t.updateAttribute=t.updateAttribute.bind(b()(t)),t.state={editingURL:!1,url:e.attributes.url,widgetType:e.attributes.widgetType||"classic",theme:e.attributes.theme||"dark",autoplay:e.attributes.autoplay||!1,previewUrl:e.attributes.previewUrl,previewEnabled:e.attributes.previewEnabled,previewAlign:e.attributes.previewAlign||"left",previewLoading:!1,previewLoadingError:!1,widget:void 0,loadPreview:!0},t._show=Object(n.createRef)(),t}return v()(o,[{key:"setUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;e&&e.preventDefault();var t=this.state,r=t.url,n=t.previewUrl,i=t.loadPreview,o=this.props.setAttributes;o({url:r}),this.setState({editingURL:!1}),!n&&i&&this.requestPreview()}},{key:"updateAttribute",value:function(e){this.setState(e),(0,this.props.setAttributes)(e)}},{key:"emitChangeUrl",value:function(){this.setState({url:void 0,editingURL:!0,previewUrl:void 0},this.setUrl)}},{key:"getWidgetProp",value:function(e){return X[this.state.widgetType][e]}},{key:"requestPreview",value:function(){var e=this;this.setState({previewLoading:!0,previewLoadingError:!1}),p()(s.a.mark((function t(){var r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(window.location.origin+"/wp-json/mea/v1/preview/?show_url="+e.state.url);case 2:if(!(r=t.sent).ok){t.next=9;break}return t.next=6,r.json();case 6:return t.abrupt("return",t.sent);case 9:console.error("HTTP ERROR: "+r.status);case 10:case"end":return t.stop()}}),t)})))().then((function(t){t&&void 0!==t.preview_url?e.updateAttribute({previewUrl:t.preview_url}):void 0!==t.error?e.setState({previewLoadingError:t.error}):e.setState({previewLoadingError:Object(i.__)("Server responded that something went wrong.")}),e.setState({previewLoading:!1})}))}},{key:"render",value:function(){var e=this,t=this.state,r=t.url,o=t.loadPreview,l=t.widgetType,c=t.previewUrl,a=t.editingURL,s=t.theme,u=t.autoplay,p=t.playing,h=t.previewEnabled,d=t.previewAlign,f=t.previewLoading,v=t.previewLoadingError,w=this.props,b=w.fetching,m=w.preview,y=w.cannotEmbed,g=w.tryAgain,O=w.isSelected;if(b)return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"wp-block-embed is-loading"},Object(n.createElement)(E.Spinner,null),Object(n.createElement)("p",null,Object(i.__)("Embedding…"))));if(!b&&(!m||y||a))return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(D,{previewInfoLink:te+"#preview",cannotEmbed:y,url:r,loadPreview:o,tryAgain:g,onSubmit:this.setUrl,onChangeUrl:function(t){return e.setState({url:t.target.value})},onChangeLoadPreview:function(){return e.setState({loadPreview:!o})}}));var j=!!this.getWidgetProp("previewIcon")&&this.getWidgetProp("previewIcon");return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(_.BlockControls,null,Object(n.createElement)(Z,{selected:l,onSelect:function(t){return e.updateAttribute({widgetType:t})}}),Object(n.createElement)(K,{value:s,onClick:function(t){return e.updateAttribute({theme:t})}}),Object(n.createElement)(E.Toolbar,{controls:[{icon:"controls-play",title:Object(i.__)("Autoplay"),isActive:u,onClick:function(t){return e.updateAttribute({autoplay:!u})}}]}),Object(n.createElement)($,{emitLoadPreview:this.requestPreview,url:c,playing:p,previewLoading:f,previewEnabled:h,togglePreviewEnabled:function(){e.updateAttribute({previewEnabled:!e.state.previewEnabled}),e._show.current.blinkPreview()},previewAlign:d,emitChangePreviewAlign:function(t){e.updateAttribute({previewAlign:t}),e._show.current.blinkPreview()}}),Object(n.createElement)(E.Toolbar,{controls:[{icon:"edit",class:"mea_preview_control",title:Object(i.__)("Edit URL"),onClick:this.emitChangeUrl}]})),v&&Object(n.createElement)(E.Notice,{status:"error",onRemove:function(){return e.setState({previewLoadingError:!1})}},v," ",Object(i.__)("You can")," ",Object(n.createElement)(E.Button,{isPrimary:!0,isSmall:!0,onClick:this.requestPreview},Object(i.__)("Try again"))," ",Object(i.__)("or")," ",Object(n.createElement)(E.Button,{isSecondary:!0,isSmall:!0,href:te,target:"_blank"},Object(i.__)("Send report"))),Object(n.createElement)(q,{ref:this._show,updateUrl:!1,url:r,height:X[l].height,previewUrl:!!h&&c,spinner:j,mini:this.getWidgetProp("mini"),autoplay:u,hideCover:this.getWidgetProp("hideCover"),hideArtwork:this.getWidgetProp("hideArtwork"),light:"light"===s,isSelected:O,previewAlign:d}))}}]),o}(n.Component),ne=function(e){return/^\s*(https?:\/\/(.+?\.)?mixcloud\.com\S+)\s*$/i.test(e)};Object(o.registerBlockType)("veliky/mixcloud-show",{title:Object(i.__)("Mixcloud Advanced","ev_mea"),icon:R,category:"embed",supports:{align:!0},attributes:{url:{type:"string"},widgetType:{type:"string"},theme:{type:"string"},autoplay:{type:"boolean"},previewUrl:{type:"string"},previewEnabled:{type:"boolean",default:!0},previewAlign:{type:"string",default:"right"}},edit:Object(l.compose)(Object(c.withSelect)((function(e,t){var r=t.attributes.url,n=e("core"),i=n.getEmbedPreview,o=n.isPreviewEmbedFallback,l=n.isRequestingEmbedPreview,c=void 0!==r,a=c&&i(r),s=c&&o(r),u=c&&l(r),p=!!a&&void 0===a.type&&!1===a.html,h=!!a&&a.data&&404===a.data.status,d=!!a&&!p&&!h;return{preview:d?a:void 0,fetching:u,cannotEmbed:c&&(!ne(r)||!d||s)}})),Object(c.withDispatch)((function(e,t){var r=t.attributes,n=r.url,i=(r.widgetType,r.theme,r.autoplay,e("core/data"));return{tryAgain:function(){i.invalidateResolution("core","getEmbedPreview",[n])}}})))(re),save:function(e){var t=e.attributes,r=t.url,i=t.widgetType,o=t.previewUrl,l=t.theme,c=t.previewAlign;if(!r)return null;var a=X[i||"classic"];return Object(n.createElement)("figure",null,Object(n.createElement)(q,{updateUrl:!0,url:r,height:a.height,previewUrl:o,spinner:a.previewIcon,mini:a.mini,hideCover:a.hideCover,hideArtwork:a.hideArtwork,light:l&&"light"===l,previewAlign:c}))}})}]);